{"version":3,"file":"commonHelpers.js","sources":["../src/js/helpers.js","../src/js/render-functions.js","../src/js/pixabay-api.js","../src/main.js"],"sourcesContent":["import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nconst MESSAGES = {\n  info: `Please enter a value in the search field!`,\n  endOfSearch: `We're sorry, but you've reached the end of search results.`,\n  warning: `Sorry, there are no images matching your search query. Please try again!`,\n  error: `Sorry, there are no connection to the server. Please try again later!`,\n  exception: `Exception: We have some issue with connection. Please try again later!`,\n};\n\nconst MESSAGES_BG_COLORS = {\n  blue: '#abd4f8',\n  orange: '#f28111',\n  red: '#e97782',\n};\n\nconst EVENT_TYPE = {\n  click: 'click',\n  submit: 'submit',\n};\n\nfunction showInfoMessage(message, color) {\n  iziToast.info({\n    position: 'topRight',\n    backgroundColor: `${color}`,\n    message: `${message}`,\n  });\n}\n\nexport { EVENT_TYPE, MESSAGES, MESSAGES_BG_COLORS, showInfoMessage };\n","import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nconst lightbox = new SimpleLightbox('.gallery a', {\n  captionsData: 'alt',\n  captionDelay: 250,\n});\n\nconst gallery = document.querySelector('.js-gallery');\n\nexport function fetchGallery(data) {\n  gallery.insertAdjacentHTML('beforeend', markupGallery(data));\n\n  lightbox.refresh();\n}\n\nfunction markupGallery(data) {\n  return data.hits\n    .map(\n      ({\n        webformatURL,\n        largeImageURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) => `\n\t\t\t\t<li class=\"gallery-item hvr-grow\">\n\t\t\t\t\t<a class=\"gallery-link\" href=\"${largeImageURL}\">\n\t\t\t\t\t\t<figure class=\"gallery-figure \">\n\t\t\t\t\t\t\t<img class=\"gallery-image\" src=\"${webformatURL}\" alt=\"${tags}\" loading=\"lazy\">\n\t\t\t\t\t\t\t<figcaption class=\"gallery-figcaption\">\n\t\t\t\t\t\t\t\t<ul class=\"img-content-wrapper\">\n\t\t\t\t\t\t\t\t\t<li>Likes<span>${likes}</span></li>\n\t\t\t\t\t\t\t\t\t<li>Views<span>${views}</span></li>\n\t\t\t\t\t\t\t\t\t<li>Comments<span>${comments}</span></li>\n\t\t\t\t\t\t\t\t\t<li>Downloads<span>${downloads}</span></li>\n\t\t\t\t\t\t\t\t</ul>\n\t\t\t\t\t\t\t</figcaption>\n\t\t\t\t\t\t</figure>\n\t\t\t\t\t</a>\n\t\t\t\t</li>\n\t\t`\n    )\n    .join('');\n}\n\nexport function fetchLoader() {\n  gallery.insertAdjacentHTML(\n    'beforeend',\n    `<div class='loader-wrapper'>\n        <div class='loader'></div>\n    </div>`\n  );\n}\n","import axios from 'axios';\nimport { MESSAGES, MESSAGES_BG_COLORS, showInfoMessage } from './helpers';\nimport { fetchLoader } from './render-functions';\n\nconst API_KEY = '42598065-1779ad5a953180c3fe77c2809';\nconst API_URL = 'https://pixabay.com/api/?';\nconst CONFIG = {\n  params: {\n    key: API_KEY,\n    image_type: 'photo',\n    orientations: 'horizontal',\n    safesearch: true,\n    page: 1,\n    per_page: 15,\n  },\n};\n\nexport async function getGalleryData(queryValue, page) {\n  try {\n    fetchLoader();\n    CONFIG.params.q = queryValue;\n    CONFIG.params.page = page;\n    const response = await axios.get(API_URL, CONFIG);\n    return response.data;\n  } catch (error) {\n    if (error.response) {\n      const { data } = error.response;\n\n      showInfoMessage(\n        `${MESSAGES.exception} ERROR: ${data}`,\n        MESSAGES_BG_COLORS.orange\n      );\n    } else if (error.request) {\n      showInfoMessage(\n        `${MESSAGES.exception} ERROR: ${error.request}`,\n        MESSAGES_BG_COLORS.orange\n      );\n    } else {\n      showInfoMessage(\n        `${MESSAGES.exception} ERROR: ${error.message}`,\n        MESSAGES_BG_COLORS.orange\n      );\n    }\n  }\n}\n","import iziToast from 'izitoast';\nimport {\n  EVENT_TYPE,\n  MESSAGES,\n  MESSAGES_BG_COLORS,\n  showInfoMessage,\n} from './js/helpers';\nimport { getGalleryData } from './js/pixabay-api';\nimport { fetchGallery } from './js/render-functions';\n\nconst form = document.querySelector('.js-search-form');\nconst gallery = document.querySelector('.js-gallery');\nconst loadMoreBtn = document.querySelector('.js-load-more-btn');\n\nlet queryString = '';\nlet currentPage = 1;\nlet evtType = '';\n\nconst IMAGE_MAX_COUNT = 15;\n\nform.addEventListener('submit', onSubmitForm);\n\nloadMoreBtn.addEventListener('click', async () => {\n  try {\n    evtType = EVENT_TYPE.click;\n    await renderGallery(queryString, currentPage);\n    const liEl = document.querySelector('li');\n    const { height } = liEl.getBoundingClientRect();\n    scrollVertical(height * 2, 0);\n  } catch (error) {\n    showInfoMessage(MESSAGES.exception + error, MESSAGES_BG_COLORS.orange);\n  }\n});\n\nasync function onSubmitForm(event) {\n  try {\n    event.preventDefault();\n\n    const target = event.target;\n    const search = target.elements.search.value.trim();\n\n    evtType = EVENT_TYPE.submit;\n\n    loadMoreBtn.classList.remove('visible');\n\n    iziToast.destroy();\n\n    if (queryString !== search || evtType === EVENT_TYPE.submit) {\n      gallery.innerHTML = '';\n      queryString = target.elements.search.value.trim();\n      currentPage = 1;\n    }\n\n    if (!search) {\n      showInfoMessage(MESSAGES.info, MESSAGES_BG_COLORS.blue);\n      gallery.innerHTML = '';\n      return;\n    }\n\n    await renderGallery(queryString, currentPage);\n\n    target.reset();\n  } catch (error) {\n    showInfoMessage(MESSAGES.exception + error, MESSAGES_BG_COLORS.orange);\n  }\n}\n\nasync function renderGallery(searchValue, page) {\n  try {\n    if (searchValue === queryString && evtType === EVENT_TYPE.click) {\n      currentPage += 1;\n      page += 1;\n    }\n\n    const galleryData = await getGalleryData(searchValue, page);\n\n    removeLoader();\n\n    if (validateGalleryData(galleryData)) {\n      const restOfImages = Math.round(galleryData.totalHits / page);\n      fetchGallery(galleryData);\n      showHideBtn(restOfImages);\n    }\n  } catch (error) {\n    showInfoMessage(MESSAGES.exception + error, MESSAGES_BG_COLORS.orange);\n  }\n}\n\nfunction scrollVertical(x = 0, y = 0) {\n  window.scrollBy({ top: x, left: y, behavior: 'smooth' });\n}\n\nfunction removeLoader() {\n  const loaderWrapper = document.querySelector('.loader-wrapper');\n  loaderWrapper.remove();\n}\n\nfunction validateGalleryData(galleryData) {\n  if (!galleryData) {\n    gallery.innerHTML = '';\n    return false;\n  } else if (galleryData && galleryData.totalHits === 0) {\n    showInfoMessage(MESSAGES.warning, MESSAGES_BG_COLORS.red);\n    gallery.innerHTML = '';\n    return false;\n  } else {\n    return true;\n  }\n}\n\nfunction showHideBtn(imagesCount) {\n  if (imagesCount <= IMAGE_MAX_COUNT) {\n    loadMoreBtn.classList.remove('visible');\n    showInfoMessage(MESSAGES.endOfSearch, MESSAGES_BG_COLORS.blue);\n    return;\n  }\n  loadMoreBtn.classList.add('visible');\n}\n"],"names":["MESSAGES","MESSAGES_BG_COLORS","EVENT_TYPE","showInfoMessage","message","color","iziToast","lightbox","SimpleLightbox","gallery","fetchGallery","data","markupGallery","webformatURL","largeImageURL","tags","likes","views","comments","downloads","fetchLoader","API_KEY","API_URL","CONFIG","getGalleryData","queryValue","page","axios","error","form","loadMoreBtn","queryString","currentPage","evtType","IMAGE_MAX_COUNT","onSubmitForm","renderGallery","liEl","height","scrollVertical","event","target","search","searchValue","galleryData","removeLoader","validateGalleryData","restOfImages","showHideBtn","x","y","imagesCount"],"mappings":"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"}